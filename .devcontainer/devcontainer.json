// https://aka.ms/devcontainer.json
// https://github.com/microsoft/vscode-dev-containers/tree/v0.205.1/containers/rust
{
	"build": {
		"args": {
			"VARIANT": "1.56.0-bullseye"
		},
		"dockerfile": "Dockerfile"
	},
	"extensions": [
		"github.vscode-pull-request-github",
		"ms-vscode-remote.vscode-remote-extensionpack",
		"ms-vscode.makefile-tools",
        "bungcip.better-toml",
        "coenraads.bracket-pair-colorizer-2",
        "eamodio.gitlens",
        "ibm.output-colorizer",
        "mhutchie.git-graph",
        "ms-azuretools.vscode-docker",
        "ms-kubernetes-tools.vscode-kubernetes-tools",
        "mtxr.sqltools",
        "mtxr.sqltools-driver-sqlite",
        "pkief.material-icon-theme",
        "redhat.vscode-yaml",
        "rust-lang.rust",
        "ryanluker.vscode-coverage-gutters",
        "serayuzgur.crates",
        "streetsidesoftware.code-spell-checker",
        "tyriar.sort-lines",
        "vadimcn.vscode-lldb"
	],	
	"forwardPorts": [
		2222,
		50050,
		50051,
		50052,
		50053,
		50054
	],
	"mounts": [
		"source=/var/run/docker.sock,target=/var/run/docker-host.sock,type=bind",
		"source=${env:HOME}${env:USERPROFILE}/.kube,target=/usr/local/share/kube-localhost,type=bind"
		// "source=${env:HOME}${env:USERPROFILE}/.minikube,target=/usr/local/share/minikube-localhost,type=bind"
	],	
	"name": "fip",
	"postStartCommand": "make fetch",
	"runArgs": [
		"--cap-add=SYS_PTRACE",
		"--init",
		// "--network=minikube",
		"--security-opt",
		"seccomp=unconfined"
	],
	"remoteEnv": {
		"LOCAL_WORKSPACE_FOLDER": "${localWorkspaceFolder}",
		"SYNC_LOCALHOST_KUBECONFIG": "true"
	},
	"overrideCommand": false,
	"remoteUser": "vscode",
	"settings": {
		"lldb.executable": "/usr/bin/lldb",
		"remote.extensionKind": {
			"coenraads.bracket-pair-colorizer-2": [
				"ui"
			],
			"ibm.output-colorizer": [
				"ui"
			],
			"ms-azuretools.vscode-docker": [
				"ui"
			],
			"ms-kubernetes-tools.vscode-kubernetes-tools": [
				"ui"
			],
			"ms-vscode-remote.vscode-remote-extensionpack": [
				"ui"
			],
			"mtxr.sqltools": [
				"ui"
			],
			"mtxr.sqltools-driver-sqlite": [
				"ui"
			],
			"pkief.material-icon-theme": [
				"ui"
			],
			"redhat.vscode-yaml": [
				"ui"
			]
		}
	},
	"shutdownAction": "stopContainer"
}
